
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Scholarship Management - ScholarVault</title>
    <meta name="description" content="Manage scholarships for ScholarVault" />
    <meta name="author" content="ScholarVault" />
    <meta property="og:image" content="/og-image.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/aos@2.3.1/dist/aos.css">
    <style>
      /* Base Variables */
      :root {
        --primary: #4e5679;
        --primary-light: #7685af;
        --primary-dark: #21253a;
        --secondary: #f5f7fa;
        --secondary-dark: #ebeef3;
        --text-primary: #21253a;
        --text-secondary: #616c98;
        --text-muted: #94a3c3;
        --border-color: #ebeef3;
        --white: #ffffff;
        --radius: 0.5rem;
        --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      }

      /* Base Styles */
      *, *::before, *::after {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      html, body {
        font-family: 'Raleway', sans-serif;
        font-size: 16px;
        line-height: 1.5;
        color: var(--text-primary);
        scroll-behavior: smooth;
      }

      body {
        min-height: 100vh;
        background: linear-gradient(to bottom, var(--secondary-dark)/0.5, white);
      }

      .container {
        width: 100%;
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 1.5rem;
      }

      h1, h2, h3, h4, h5, h6 {
        font-family: 'Playfair Display', serif;
        font-weight: 700;
        line-height: 1.2;
      }

      /* Admin Navigation */
      .admin-nav {
        position: sticky;
        top: 0;
        z-index: 50;
        padding: 16px 24px;
        box-shadow: var(--shadow-sm);
        background-color: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(5px);
        border-bottom: 1px solid var(--border-color);
      }

      .admin-nav .container {
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .admin-nav .logo-container {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .admin-nav .logo {
        font-size: 1.5rem;
        font-family: 'Playfair Display', serif;
        font-weight: 700;
        color: var(--primary-dark);
        display: flex;
        align-items: center;
        text-decoration: none;
      }

      .admin-nav .logo svg {
        margin-right: 8px;
      }

      .admin-nav .logo-badge {
        font-size: 0.875rem;
        font-family: 'Raleway', sans-serif;
        font-weight: 500;
        padding: 2px 8px;
        border-radius: 6px;
        background-color: rgba(33, 37, 58, 0.1);
        color: var(--primary-dark);
        margin-left: 12px;
        text-decoration: none;
      }

      .admin-nav .nav-right {
        display: flex;
        align-items: center;
        gap: 16px;
      }

      .admin-nav .back-btn {
        padding: 8px 16px;
        border-radius: 8px;
        background-color: var(--primary);
        color: white;
        border: none;
        font-size: 0.875rem;
        font-weight: 500;
        cursor: pointer;
        transition: background-color 0.3s ease;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .admin-nav .back-btn:hover {
        background-color: var(--primary-light);
      }

      /* Main Content */
      main {
        padding: 48px 24px;
      }

      .page-header {
        margin-bottom: 48px;
      }

      .page-header h1 {
        font-size: 2.5rem;
        margin-bottom: 16px;
        text-align: center;
      }

      .page-header p {
        font-size: 1.125rem;
        color: var(--text-secondary);
        max-width: 48rem;
        text-align: center;
        margin: 0 auto;
      }

      /* Scholarship Management Styles */
      .scholarship-management {
        max-width: 900px;
        margin: 0 auto;
      }
      .scholarship-management .glass-card h2 {
    margin-bottom: 24px; /* Add margin-bottom to create space */
}

      .glass-card {
        background: rgba(255, 255, 255, 0.7);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.18);
        border-radius: 12px;
        padding: 24px;
        box-shadow: var(--shadow-lg);
        margin-bottom: 32px;
      }

      .form-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 16px;
      }

      @media (max-width: 768px) {
        .form-grid {
          grid-template-columns: 1fr;
        }
      }

      .form-full-width {
        grid-column: 1 / -1;
      }

      .form-group {
        margin-bottom: 20px;
      }

      .form-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
        font-size: 0.875rem;
        color: var(--text-primary);
      }

      .input-control {
        width: 100%;
        padding: 12px 16px;
        border-radius: 8px;
        border: 1px solid var(--border-color);
        background-color: white;
        font-family: 'Raleway', sans-serif;
        transition: border-color 0.3s, box-shadow 0.3s;
      }

      .input-control:focus {
        outline: none;
        border-color: var(--primary-light);
        box-shadow: 0 0 0 3px rgba(78, 86, 121, 0.15);
      }

      textarea.input-control {
        min-height: 120px;
        resize: vertical;
      }

      .actions-bar {
        display: flex;
        justify-content: flex-end;
        gap: 16px;
        margin-top: 8px;
      }

      .btn {
        padding: 12px 24px;
        border-radius: 8px;
        border: none;
        font-family: 'Raleway', sans-serif;
        font-size: 0.875rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        justify-content: center;
      }

      .btn-primary {
        background-color: var(--primary);
        color: white;
      }

      .btn-primary:hover {
        background-color: var(--primary-light);
      }

      .btn-secondary {
        background-color: var(--secondary-dark);
        color: var(--text-primary);
      }

      .btn-secondary:hover {
        background-color: var(--secondary);
      }

      .btn-danger {
        background-color: #ef4444;
        color: white;
      }

      .btn-danger:hover {
        background-color: #dc2626;
      }

      .scholarship-list {
        margin-top: 32px;
      }

      .scholarship-list h2 {
        font-size: 1.5rem;
        margin-bottom: 20px;
        color: var(--primary-dark);
      }

      .scholarship-table {
        width: 100%;
        border-collapse: collapse;
      }

      .scholarship-table th {
        text-align: left;
        padding: 12px 16px;
        background-color: var(--secondary-dark);
        color: var(--text-primary);
        font-weight: 600;
        font-size: 0.875rem;
      }

      .scholarship-table tr {
        border-bottom: 1px solid var(--border-color);
        transition: background-color 0.3s;
      }

      .scholarship-table tr:hover {
        background-color: var(--secondary);
      }

      .scholarship-table td {
        padding: 16px;
        vertical-align: middle;
      }

      .scholarship-table .scholarship-title {
        font-weight: 600;
        color: var(--primary-dark);
      }

      .scholarship-table .scholarship-amount {
        font-weight: 600;
        color: var(--primary);
      }

      .scholarship-table .scholarship-deadline {
        color: var(--text-secondary);
        font-size: 0.875rem;
      }

      .scholarship-action-btn {
        background: none;
        border: none;
        cursor: pointer;
        color: var(--text-secondary);
        padding: 8px;
        border-radius: 4px;
        transition: background-color 0.3s, color 0.3s;
      }

      .scholarship-action-btn:hover {
        background-color: var(--secondary-dark);
        color: var(--primary);
      }

      .scholarship-action-btn i {
        font-size: 1rem;
      }

      /* Status Badges */
      .status-badge {
        display: inline-block;
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 600;
      }

      .status-active {
        background-color: rgba(16, 185, 129, 0.1);
        color: #10b981;
      }

      .status-draft {
        background-color: rgba(249, 168, 37, 0.1);
        color: #f9a825;
      }

      .status-closed {
        background-color: rgba(239, 68, 68, 0.1);
        color: #ef4444;
      }

      /* Empty State */
      .empty-state {
        text-align: center;
        padding: 48px 24px;
        background-color: var(--secondary);
        border-radius: 12px;
        margin-top: 32px;
      }

      .empty-state i {
        font-size: 3rem;
        color: var(--text-muted);
        margin-bottom: 16px;
      }

      .empty-state h3 {
        margin-bottom: 8px;
        font-size: 1.25rem;
      }

      .empty-state p {
        color: var(--text-secondary);
        margin-bottom: 24px;
      }

      /* Toast notifications */
      .toast-container {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 1000;
      }

      .toast {
        background-color: var(--primary-dark);
        color: white;
        padding: 12px 16px;
        border-radius: 8px;
        margin-top: 8px;
        box-shadow: var(--shadow-lg);
        max-width: 300px;
        opacity: 0;
        transform: translateY(20px);
        animation: fadeIn 0.3s forwards, fadeOut 0.3s 4.7s forwards;
      }

      @keyframes fadeIn {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes fadeOut {
        to {
          opacity: 0;
          transform: translateY(-20px);
        }
      }

      .footer {
    background-color: var(--primary-dark);
    color: var(--white);
    padding: 3rem 0 2rem;
}

.footer-bottom {
    padding-top: 2rem;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    text-align: center;
}

.footer-bottom p {
    color: rgba(255, 255, 255, 0.5);
    font-size: 0.875rem;
    margin-bottom: 0;
}

.contact-info {
    color: rgba(255, 255, 255, 0.7);
    margin-bottom: 1rem;
}
      footer .container {
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      @media (min-width: 768px) {
        footer .container {
          flex-direction: row;
          justify-content: space-between;
        }
      }

      footer .footer-logo {
        display: flex;
        align-items: center;
        font-size: 1.25rem;
        font-family: 'Playfair Display', serif;
        font-weight: 700;
        margin-bottom: 16px;
      }

      footer .footer-logo svg {
        margin-right: 8px;
      }

      footer .footer-text {
        font-size: 0.875rem;
        color: rgba(255, 255, 255, 0.7);
        margin-top: 4px;
      }

      footer .copyright {
        font-size: 0.875rem;
        color: rgba(255, 255, 255, 0.7);
      }

      /* Filter dropdown styles */
      .filter-container {
        margin-bottom: 24px;
        display: flex;
        gap: 16px;
        align-items: center;
        flex-wrap: wrap;
      }

      .filter-dropdown {
        position: relative;
        display: inline-block;
      }

      .filter-dropdown select {
        appearance: none;
        -webkit-appearance: none;
        -moz-appearance: none;
        padding: 10px 32px 10px 12px;
        border-radius: 8px;
        border: 1px solid var(--border-color);
        background-color: white;
        font-family: 'Raleway', sans-serif;
        font-size: 0.875rem;
        cursor: pointer;
      }

      .filter-dropdown::after {
        content: '▼';
        font-size: 0.7rem;
        position: absolute;
        right: 12px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text-secondary);
        pointer-events: none;
      }

      .search-box {
        flex-grow: 1;
        position: relative;
      }

      .search-box input {
        width: 100%;
        padding: 10px 16px 10px 36px;
        border-radius: 8px;
        border: 1px solid var(--border-color);
        background-color: white;
        font-family: 'Raleway', sans-serif;
        font-size: 0.875rem;
      }

      .search-box i {
        position: absolute;
        left: 12px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text-secondary);
      }
      .criteria-entry {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 10px;
  }
  .criteria-field {
    flex: 1;
  }
  .btn-small {
    padding: 5px 10px;
    font-size: 0.9em;
  }
  .btn-danger {
    background-color: #dc3545;
    color: white;
  }
  .btn-danger:hover {
    background-color: #c82333;
  }
    </style>
  </head>

  <body>
    <!-- Admin Navigation -->
    <header class="admin-nav">
      <div class="container">
        <div class="logo-container">
          <a href="adminlov.html" class="logo">
            <svg viewBox="0 0 24 24" width="28" height="28" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round">
              <path d="M22 10v6M2 10l10-5 10 5-10 5z"></path>
              <path d="M6 12v5c0 2 2 3 6 3s6-1 6-3v-5"></path>
            </svg>
            <span>ScholarVault</span>
            <span class="logo-badge">Admin</span>
          </a>
        </div>

      </div>
    </header>
    
    <main>
      <div class="container">
        <!-- Page Header -->
        <div class="page-header" data-aos="fade-up">
          <h1>Scholarship Management</h1>
          <p>Create and manage scholarships for students, including eligibility criteria and deadlines.</p>
        </div>
        
        <!-- Scholarship Form -->
<!-- Scholarship Form -->
<div class="scholarship-management">
  <div class="glass-card" data-aos="fade-up" data-aos-delay="100">
    <h2 class="mb-4">Create New Scholarship</h2>
    
    <form id="scholarshipForm">
      <div class="form-grid">
        <!-- Scholarship Name -->
        <div class="form-group">
          <label for="name">Scholarship Name</label>
          <input type="text" id="name" class="input-control" placeholder="Enter scholarship name" required>
        </div>
        
        <!-- Amount -->
        <div class="form-group">
          <label for="amount">Scholarship Amount</label>
          <input type="number" id="amount" class="input-control" placeholder="Enter amount" min="0" step="0.01" required>
        </div>
        
        <!-- Organization -->
        <div class="form-group">
          <label for="organization">Organization</label>
          <input type="text" id="organization" class="input-control" placeholder="Enter the organization offering the scholarship">
        </div>
        
        <!-- Application Deadline -->
        <div class="form-group">
          <label for="deadline">Application Deadline</label>
          <input type="date" id="deadline" class="input-control">
        </div>
        
        <!-- Category -->
        <div class="form-group">
          <label for="category">Category</label>
          <select id="category" class="input-control">
            <option value="">Select Category</option>
            <option value="Any">Any</option>
            <option value="General">General</option>
            <option value="SC">SC</option>
            <option value="ST">ST</option>
            <option value="OBC">OBC</option>
            <option value="EWS">EWS</option>
          </select>
        </div>
        
        <!-- Minimum CGPA -->
        <div class="form-group">
          <label for="cgpa">Minimum CGPA</label>
          <input type="number" id="cgpa" class="input-control" placeholder="Enter minimum CGPA (e.g., 3.0)" min="0" max="4" step="0.1">
        </div>
        
        <!-- Minimum 12th Marks -->
        <div class="form-group">
          <label for="twelfth_marks">Minimum 12th Grade Marks (%)</label>
          <input type="number" id="twelfth_marks" class="input-control" placeholder="Enter minimum 12th grade marks (e.g., 75)" min="0" max="100" step="0.1">
        </div>
        
        <!-- Gender Eligibility -->
        <div class="form-group">
          <label for="gender">Gender Eligibility</label>
          <select id="gender" class="input-control">
            <option value="Any">Any</option>
            <option value="Male">Male</option>
            <option value="Female">Female</option>
            <option value="Other">Other</option>
          </select>
        </div>
        
        <!-- Family Income Eligibility -->
        <div class="form-group">
          <label for="income">Family Income Eligibility</label>
          <select id="income" class="input-control">
            <option value="Any">Any</option>
            <option value="below-1l">Below ₹1,00,000</option>
            <option value="1l-3l">₹1,00,000 - ₹3,00,000</option>
            <option value="3l-6l">₹3,00,000 - ₹6,00,000</option>
            <option value="6l-10l">₹6,00,000 - ₹10,00,000</option>
          </select>
        </div>
        
        <!-- Special Category -->
        <div class="form-group">
          <label for="special_category">Special Category</label>
          <select id="special_category" class="input-control">
            <option value="">None</option>
            <option value="Person with Disability (PwD)">Person with Disability (PwD)</option>
            <option value="Single Girl Child">Single Girl Child</option>
            <option value="Sports Excellence">Sports Excellence</option>
            <option value="Rural Background">Rural Background</option>
            <option value="Orphan / Child of a Single Parent">Orphan / Child of a Single Parent</option>
            <option value="Defense / Ex-Servicemen Quota">Defense / Ex-Servicemen Quota</option>
            <option value="Minority Community (Muslim, Sikh, Christian, etc.)">Minority Community (Muslim, Sikh, Christian, etc.)</option>
          </select>
        </div>
        
        <!-- Description -->
        <div class="form-group form-full-width">
          <label for="description">Description</label>
          <textarea id="description" class="input-control" placeholder="Enter detailed scholarship description"></textarea>
        </div>
        
        <!-- Dynamic Criteria Input -->
        <div class="form-group form-full-width">
          <label>Additional Criteria</label>
          <div id="criteriaContainer">
            <!-- Criteria entries will be added here dynamically -->
          </div>
          <button type="button" class="btn btn-secondary" onclick="addCriteriaField()">
            <i class="fas fa-plus mr-2"></i> Add Criteria
          </button>
        </div>
        
        <!-- About the Program -->
        <div class="form-group form-full-width">
          <label for="about_the_program">About the Program</label>
          <textarea id="about_the_program" class="input-control" placeholder="Enter information about the scholarship program"></textarea>
        </div>
        
        <!-- Eligibility Criteria -->
        <div class="form-group form-full-width">
          <label for="eligibility">Eligibility Criteria</label>
          <textarea id="eligibility" class="input-control" placeholder="Enter detailed eligibility criteria"></textarea>
        </div>
        
        <!-- Benefits -->
        <div class="form-group form-full-width">
          <label for="benefits">Benefits</label>
          <textarea id="benefits" class="input-control" placeholder="Enter the benefits provided by the scholarship"></textarea>
        </div>
        
        <!-- Application Link -->
        <div class="form-group form-full-width">
          <label for="application_link">Application Link</label>
          <input type="url" id="application_link" class="input-control" placeholder="Enter the URL for the scholarship application">
        </div>
      </div>
      
      <div class="actions-bar">
        <button type="reset" class="btn btn-secondary" onclick="clearCriteriaFields()">
          <i class="fas fa-redo-alt mr-2"></i> Reset
        </button>
        <button type="button" onclick="addScholarship()" class="btn btn-primary">
          <i class="fas fa-plus mr-2"></i> Add Scholarship
        </button>
      </div>
    </form>
  </div>
</div>
          
           
        </div>
      </div>
    </main>
    
    <footer class="footer">
      <div class="container">
          <div class="footer-content">
              <div class="contact-info mb-4">
                  <h4>Contact Us</h4>
                  <p>scholarvault@gmail.com</p>
                  <p>6238280918</p>
              </div>
          </div>
          
      </div>
  </footer>
    <!-- Toast container -->
    <div class="toast-container" id="toast-container"></div>

    <!-- Scripts -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
      // Initialize animations
      document.addEventListener('DOMContentLoaded', function() {
        AOS.init({
          duration: 800,
          easing: 'ease-out',
          once: false,
          mirror: true
        });
    
        // Check if admin is logged in
        const token = localStorage.getItem('authToken');
        if (!token) {
          showToast("Please log in to manage scholarships.", 'error');
          setTimeout(() => {
            window.location.href = 'admin-login.html'; // Redirect to login page
          }, 3000);
          return;
        }
    
        // Fetch and display existing scholarships on page load
        fetchScholarships();
    
        // Add an initial criteria field
        addCriteriaField();
      });
    
      // Toast notification system
      function showToast(message, type = 'info') {
        const container = document.getElementById('toast-container');
        const toast = document.createElement('div');
        toast.className = `toast toast-${type}`;
        toast.textContent = message;
        container.appendChild(toast);
    
        setTimeout(() => {
          container.removeChild(toast);
        }, 5000);
      }
    
      // Function to add a new criteria field
      function addCriteriaField() {
        const container = document.getElementById('criteriaContainer');
        const criteriaEntry = document.createElement('div');
        criteriaEntry.className = 'criteria-entry';
        criteriaEntry.innerHTML = `
          <div class="form-group criteria-field">
            <label>Criteria Key</label>
            <input type="text" class="input-control criteria-key" placeholder="e.g., field" required>
          </div>
          <div class="form-group criteria-field">
            <label>Criteria Value</label>
            <input type="text" class="input-control criteria-value" placeholder="e.g., Engineering" required>
          </div>
          <button type="button" class="btn btn-danger btn-small" onclick="removeCriteriaField(this)">
            <i class="fas fa-trash-alt mr-2"></i> Remove
          </button>
        `;
        container.appendChild(criteriaEntry);
      }
    
      // Function to remove a criteria field
      function removeCriteriaField(button) {
        const container = document.getElementById('criteriaContainer');
        if (container.children.length > 1) { // Ensure at least one field remains
          container.removeChild(button.parentElement);
        } else {
          showToast('At least one criteria field is required.', 'error');
        }
      }
    
      // Function to clear criteria fields on reset
      function clearCriteriaFields() {
        const container = document.getElementById('criteriaContainer');
        container.innerHTML = '';
        addCriteriaField(); // Add one field back after clearing
      }
    
      // Fetch scholarships from the backend
      async function fetchScholarships() {
        try {
          const token = localStorage.getItem('authToken');
          const response = await fetch('http://127.0.0.1:5000/scholarships', {
            method: 'GET',
            headers: {
              'Authorization': `Bearer ${token}`,
              'Content-Type': 'application/json'
            }
          });
    
          const data = await response.json();
          if (data.status === 'success') {
            renderScholarships(data.data);
          } else {
            showToast(data.message, 'error');
          }
        } catch (error) {
          console.error('Error fetching scholarships:', error);
         // showToast('Failed to fetch scholarships. Please try again later.', 'error');
        }
      }
    
      // Render scholarships in the table
      function renderScholarships(scholarships) {
        const scholarshipList = document.getElementById('scholarshipList');
        scholarshipList.innerHTML = '';
    
        if (scholarships.length === 0) {
          document.getElementById('emptyState').style.display = 'block';
          return;
        }
    
        document.getElementById('emptyState').style.display = 'none';
    
        scholarships.forEach((scholarship, index) => {
          const formattedDeadline = scholarship.deadline
            ? new Date(scholarship.deadline).toLocaleDateString('en-US', {
                month: 'short',
                day: 'numeric',
                year: 'numeric'
              })
            : 'N/A';
    
          const statusClass = scholarship.status === 'active' ? 'status-active' :
                             scholarship.status === 'draft' ? 'status-draft' : 'status-closed';
    
          const row = document.createElement('tr');
          row.setAttribute('data-status', scholarship.status || 'draft');
          row.innerHTML = `
            <td class="scholarship-title">${scholarship.name}</td>
            <td class="scholarship-amount">$${Number(scholarship.amount).toLocaleString()}</td>
            <td class="scholarship-deadline">${formattedDeadline}</td>
            <td><span class="status-badge ${statusClass}">${(scholarship.status || 'draft').charAt(0).toUpperCase() + (scholarship.status || 'draft').slice(1)}</span></td>
            <td>
              <div style="display: flex; gap: 8px;">
                <button class="scholarship-action-btn" onclick="editScholarship(${index})">
                  <i class="fas fa-edit"></i>
                </button>
                <button class="scholarship-action-btn" onclick="deleteScholarship(${scholarship.id})">
                  <i class="fas fa-trash-alt"></i>
                </button>
              </div>
            </td>
          `;
          scholarshipList.appendChild(row);
        });
    
        AOS.refresh();
      }
    
      // Add new scholarship
      async function addScholarship() {
        // Collect criteria key-value pairs
        const criteriaEntries = document.querySelectorAll('.criteria-entry');
        const criteria = {};
    
        for (const entry of criteriaEntries) {
          const key = entry.querySelector('.criteria-key').value.trim();
          const value = entry.querySelector('.criteria-value').value.trim();
    
          if (!key || !value) {
            showToast('Please fill in all criteria fields.', 'error');
            return;
          }
    
          criteria[key] = value;
        }
    
        const scholarshipData = {
          name: document.getElementById('name').value.trim(),
          amount: document.getElementById('amount').value,
          organization: document.getElementById('organization').value.trim(),
          description: document.getElementById('description').value.trim(),
          deadline: document.getElementById('deadline').value,
          category: document.getElementById('category').value,
          cgpa: document.getElementById('cgpa').value ? parseFloat(document.getElementById('cgpa').value) : null,
          twelfth_marks: document.getElementById('twelfth_marks').value ? parseFloat(document.getElementById('twelfth_marks').value) : null,
          gender: document.getElementById('gender').value,
          income: document.getElementById('income').value,
          special_category: document.getElementById('special_category').value,
          criteria: Object.keys(criteria).length > 0 ? criteria : null,
          about_the_program: document.getElementById('about_the_program').value.trim(),
          eligibility: document.getElementById('eligibility').value.trim(),
          benefits: document.getElementById('benefits').value.trim(),
          application_link: document.getElementById('application_link').value.trim()
        };
    
        // Client-side validation
        if (!scholarshipData.name || !scholarshipData.amount) {
          showToast('Please fill in all required fields (Name and Amount).', 'error');
          return;
        }
    
        try {
          const token = localStorage.getItem('authToken');
          const response = await fetch('http://127.0.0.1:5000/scholarships', {
            method: 'POST',
            headers: {
              'Authorization': `Bearer ${token}`,
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(scholarshipData)
          });
    
          const data = await response.json();
    
          if (data.status === 'success') {
            showToast(`Scholarship "${data.data.name}" has been created.`, 'success');
            document.getElementById('scholarshipForm').reset();
            clearCriteriaFields();
            fetchScholarships();
          } else {
            showToast(data.message, 'error');
          }
        } catch (error) {
          console.error('Error adding scholarship:', error);
          showToast('Failed to add scholarship. Please try again later.', 'error');
        }
      }
    
      // Delete scholarship (placeholder, requires backend endpoint)
      async function deleteScholarship(scholarshipId) {
        if (confirm('Are you sure you want to delete this scholarship?')) {
          try {
            const token = localStorage.getItem('authToken');
            const response = await fetch(`http://127.0.0.1:5000/scholarships/${scholarshipId}`, {
              method: 'DELETE',
              headers: {
                'Authorization': `Bearer ${token}`,
                'Content-Type': 'application/json'
              }
            });
    
            const data = await response.json();
    
            if (data.status === 'success') {
              showToast(data.message, 'success');
              fetchScholarships();
            } else {
              showToast(data.message, 'error');
            }
          } catch (error) {
            console.error('Error deleting scholarship:', error);
            showToast('Failed to delete scholarship. Please try again later.', 'error');
          }
        }
      }
    
      // Edit scholarship (placeholder, requires backend endpoint)
      function editScholarship(index) {
        fetchScholarships().then(() => {
          const scholarshipList = document.getElementById('scholarshipList').getElementsByTagName('tr');
          if (index >= 0 && index < scholarshipList.length) {
            const scholarship = scholarships[index];
            if (!scholarship) return;
    
            document.getElementById('name').value = scholarship.name;
            document.getElementById('description').value = scholarship.description;
            document.getElementById('deadline').value = scholarship.deadline;
            document.getElementById('eligibility').value = scholarship.eligibility;
            document.getElementById('amount').value = scholarship.amount;
            document.getElementById('status').value = scholarship.status;
    
            document.querySelector('.scholarship-management').scrollIntoView({
              behavior: 'smooth'
            });
    
            document.getElementById('name').focus();
    
            showToast('Editing scholarship: ' + scholarship.name, 'info');
          }
        });
      }
    
      // Filter scholarships
      function filterScholarships() {
        const searchTerm = document.getElementById('searchScholarship').value.toLowerCase();
        const statusFilter = document.getElementById('statusFilter').value;
        const rows = document.getElementById('scholarshipList').getElementsByTagName('tr');
        let visibleCount = 0;
    
        for (let i = 0; i < rows.length; i++) {
          const titleElement = rows[i].querySelector('.scholarship-title');
          const rowStatus = rows[i].getAttribute('data-status');
    
          if (!titleElement) continue;
    
          const title = titleElement.textContent.toLowerCase();
          const matchesSearch = title.includes(searchTerm);
          const matchesStatus = statusFilter === 'all' || rowStatus === statusFilter;
    
          if (matchesSearch && matchesStatus) {
            rows[i].style.display = '';
            visibleCount++;
          } else {
            rows[i].style.display = 'none';
          }
        }
    
        document.getElementById('emptyState').style.display = visibleCount === 0 ? 'block' : 'none';
      }
    </script>
    </body>
    </html>