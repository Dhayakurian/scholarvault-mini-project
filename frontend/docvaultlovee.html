<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ScholarVault - Document Repository</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* Base Styles */
    :root {
      --primary: #4e5679;
      --primary-light: #7685af;
      --primary-dark: #21253a;
      --secondary: #f5f7fa;
      --secondary-dark: #ebeef3;
      --text-primary: #21253a;
      --text-secondary: #616c98;
      --text-muted: #94a3c3;
      --border-color: #ebeef3;
      --white: #ffffff;
      --radius: 0.5rem;
      --success: #10b981;
      --warning: #f59e0b;
      --error: #ef4444;
      --info: #3b82f6;
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }

    *, *::before, *::after {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      font-family: 'Raleway', sans-serif;
      font-size: 16px;
      line-height: 1.5;
      color: var(--text-primary);
      scroll-behavior: smooth;
      background-color: var(--secondary);
    }

    .container {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1.5rem;
    }

    h1, h2, h3, h4, h5, h6 {
      font-family: 'Playfair Display', serif;
      font-weight: 700;
      line-height: 1.2;
      margin-bottom: 1rem;
    }

    h1 {
      font-size: 2.5rem;
      color: var(--primary-dark);
    }

    h2 {
      font-size: 1.8rem;
      color: var(--primary);
      border-bottom: 2px solid var(--primary-light);
      padding-bottom: 0.5rem;
      margin-top: 2rem;
      margin-bottom: 1.5rem;
    }

    p {
      margin-bottom: 1rem;
    }

    a {
      color: var(--primary);
      text-decoration: none;
      transition: color 0.3s ease;
    }

    a:hover {
      color: var(--primary-light);
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.5rem 1rem;
      border-radius: var(--radius);
      font-weight: 600;
      transition: all 0.3s ease;
      cursor: pointer;
      font-size: 0.875rem;
      border: none;
    }

    .btn-primary {
      background-color: var(--primary);
      color: var(--white);
    }

    .btn-primary:hover {
      background-color: var(--primary-light);
    }

    .btn-danger {
      background-color: var(--error);
      color: var(--white);
    }

    .btn-danger:hover {
      opacity: 0.9;
    }

    .mb-4 {
      margin-bottom: 1rem;
    }

    .mb-8 {
      margin-bottom: 2rem;
    }

    .text-center {
      text-align: center;
    }

    /* Navbar Styles */
    .navbar {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background-color: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(5px);
      z-index: 1000;
      box-shadow: var(--shadow-sm);
      padding: 1rem 0;
    }

    .navbar-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      font-family: 'Playfair Display', serif;
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--primary-dark);
      display: flex;
      align-items: center;
    }

    .logo-icon {
      margin-right: 0.5rem;
      color: var(--primary);
    }

    /* Document List Styles */
    .document-vault {
      padding-top: 6rem;
      padding-bottom: 3rem;
    }

    .document-container {
      background-color: var(--white);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 2rem;
      margin-bottom: 2rem;
    }

    .document-section {
      margin-bottom: 2rem;
    }

    .document-list {
      list-style-type: none;
      padding-left: 1.5rem;
    }

    .document-list li {
      position: relative;
      padding: 0.75rem 0;
      padding-left: 2rem;
      border-bottom: 1px solid var(--border-color);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .document-list li:last-child {
      border-bottom: none;
    }

    .document-list li::before {
      content: "";
      position: absolute;
      left: 0;
      top: 1rem;
      width: 1.25rem;
      height: 1.25rem;
      background-color: var(--primary-light);
      opacity: 0.2;
      border-radius: 50%;
    }

    .document-list li::after {
      content: "âœ“";
      position: absolute;
      left: 0.35rem;
      top: 0.75rem;
      color: var(--primary);
      font-weight: bold;
    }

    .document-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 2rem;
    }

    .upload-btn {
      background-color: var(--primary);
      color: white;
      padding: 0.75rem 1.5rem;
      border-radius: var(--radius);
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    .upload-btn:hover {
      background-color: var(--primary-light);
    }

    .action-buttons {
      display: flex;
      gap: 0.5rem;
    }

    /* Custom Certificate Styles */
    .custom-certificate {
      background-color: var(--secondary);
      border-radius: var(--radius);
      padding: 1.5rem;
      margin-top: 2rem;
      border: 1px solid var(--border-color);
    }

    .certificate-input {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      align-items: flex-end;
      margin-top: 1rem;
    }

    .form-group {
      flex: 1;
      min-width: 200px;
    }

    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
      font-size: 0.875rem;
      color: var(--text-primary);
    }

    .form-group input {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid var(--border-color);
      border-radius: var(--radius);
      font-family: 'Raleway', sans-serif;
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    .form-group input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 2px rgba(78, 86, 121, 0.1);
    }

    /* Footer Styles */
    .footer {
      background-color: var(--primary-dark);
      color: var(--white);
      padding: 3rem 0 2rem;
    }

    .footer-bottom {
      padding-top: 2rem;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      text-align: center;
    }

    .footer-bottom p {
      color: rgba(255, 255, 255, 0.5);
      font-size: 0.875rem;
      margin-bottom: 0;
    }

    .contact-info {
      color: rgba(255, 255, 255, 0.7);
      margin-bottom: 1rem;
    }

    .hidden-file-input {
      display: none;
    }

    #custom-certificates-list {
      margin-top: 1rem;
    }

    @media (max-width: 768px) {
      .document-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 1rem;
      }
      
      h1 {
        font-size: 1.8rem;
      }
      
      h2 {
        font-size: 1.5rem;
      }
      
      .upload-btn {
        width: 100%;
        text-align: center;
      }

      .document-list li {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
      }

      .action-buttons {
        width: 100%;
        justify-content: flex-end;
      }

      .certificate-input {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <!-- Navigation Bar -->
  <header class="navbar">
    <div class="container">
      <div class="navbar-content">
        <a href="homemp.html" class="logo">
          <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="logo-icon">
            <path d="M22 10v6M2 10l10-5 10 5-10 5z"></path>
            <path d="M6 12v5c0 2 2 3 6 3s6-1 6-3v-5"></path>
          </svg>
          ScholarVault
        </a>
      </div>
    </div>
  </header>

  <!-- Document Vault Section -->
  <section class="document-vault">
    <div class="container">
      <div class="document-container">
        <div class="document-header">
          <h1>Document Vault</h1>
        </div>
        <p class="mb-4">Store and manage all your important documents in one secure place. Upload your documents to streamline your scholarship applications.</p>

        <!-- Document Section 1 -->
        <div class="document-section">
          <h2>1. Personal Identification</h2>
          <ul class="document-list">
            <li>
              Aadhaar Card
              <div class="action-buttons">
                <input type="file" id="aadhaar-upload" class="hidden-file-input">
                <button class="btn btn-primary upload-doc-btn" data-target="aadhaar-upload">Upload</button>
                <button class="btn btn-danger delete-doc-btn">Delete</button>
              </div>
            </li>
            <li>
              PAN Card
              <div class="action-buttons">
                <input type="file" id="pan-upload" class="hidden-file-input">
                <button class="btn btn-primary upload-doc-btn" data-target="pan-upload">Upload</button>
                <button class="btn btn-danger delete-doc-btn">Delete</button>
              </div>
            </li>
            <li>
              Birth Certificate
              <div class="action-buttons">
                <input type="file" id="birth-upload" class="hidden-file-input">
                <button class="btn btn-primary upload-doc-btn" data-target="birth-upload">Upload</button>
                <button class="btn btn-danger delete-doc-btn">Delete</button>
              </div>
            </li>
            <li>
              Passport
              <div class="action-buttons">
                <input type="file" id="passport-upload" class="hidden-file-input">
                <button class="btn btn-primary upload-doc-btn" data-target="passport-upload">Upload</button>
                <button class="btn btn-danger delete-doc-btn">Delete</button>
              </div>
            </li>
            <li>
              Driving License
              <div class="action-buttons">
                <input type="file" id="license-upload" class="hidden-file-input">
                <button class="btn btn-primary upload-doc-btn" data-target="license-upload">Upload</button>
                <button class="btn btn-danger delete-doc-btn">Delete</button>
              </div>
            </li>
          </ul>
        </div>

        <!-- Document Section 2 -->
        <div class="document-section">
          <h2>2. Academic Records</h2>
          <ul class="document-list">
            <li>
              10th Mark Sheet
              <div class="action-buttons">
                <input type="file" id="10th-marksheet-upload" class="hidden-file-input">
                <button class="btn btn-primary upload-doc-btn" data-target="10th-marksheet-upload">Upload</button>
                <button class="btn btn-danger delete-doc-btn">Delete</button>
              </div>
            </li>
            <li>
              12th Mark Sheet
              <div class="action-buttons">
                <input type="file" id="12th-marksheet-upload" class="hidden-file-input">
                <button class="btn btn-primary upload-doc-btn" data-target="12th-marksheet-upload">Upload</button>
                <button class="btn btn-danger delete-doc-btn">Delete</button>
              </div>
            </li>
            <li>
              UG Mark Sheet
              <div class="action-buttons">
                <input type="file" id="ug-marksheet-upload" class="hidden-file-input">
                <button class="btn btn-primary upload-doc-btn" data-target="ug-marksheet-upload">Upload</button>
                <button class="btn btn-danger delete-doc-btn">Delete</button>
              </div>
            </li>
            <li>
              PG Mark Sheet
              <div class="action-buttons">
                <input type="file" id="pg-marksheet-upload" class="hidden-file-input">
                <button class="btn btn-primary upload-doc-btn" data-target="pg-marksheet-upload">Upload</button>
                <button class="btn btn-danger delete-doc-btn">Delete</button>
              </div>
            </li>
            <li>
              Passing Certificate
              <div class="action-buttons">
                <input type="file" id="passing-upload" class="hidden-file-input">
                <button class="btn btn-primary upload-doc-btn" data-target="passing-upload">Upload</button>
                <button class="btn btn-danger delete-doc-btn">Delete</button>
              </div>
            </li>
            <li>
              School Transfer Certificate (TC)
              <div class="action-buttons">
                <input type="file" id="school-tc-upload" class="hidden-file-input">
                <button class="btn btn-primary upload-doc-btn" data-target="school-tc-upload">Upload</button>
                <button class="btn btn-danger delete-doc-btn">Delete</button>
              </div>
            </li>
            <li>
              College Transfer Certificate (TC)
              <div class="action-buttons">
                <input type="file" id="college-tc-upload" class="hidden-file-input">
                <button class="btn btn-primary upload-doc-btn" data-target="college-tc-upload">Upload</button>
                <button class="btn btn-danger delete-doc-btn">Delete</button>
              </div>
            </li>
            <li>
              Degree Certificate
              <div class="action-buttons">
                <input type="file" id="degree-upload" class="hidden-file-input">
                <button class="btn btn-primary upload-doc-btn" data-target="degree-upload">Upload</button>
                <button class="btn btn-danger delete-doc-btn">Delete</button>
              </div>
            </li>
            <li>
              Bonafide Certificate
              <div class="action-buttons">
                <input type="file" id="bonafide-upload" class="hidden-file-input">
                <button class="btn btn-primary upload-doc-btn" data-target="bonafide-upload">Upload</button>
                <button class="btn btn-danger delete-doc-btn">Delete</button>
              </div>
            </li>
          </ul>
        </div>

        <!-- Document Section 3 -->
        <div class="document-section">
          <h2>3. Scholarship & Financial Documents</h2>
          <ul class="document-list">
            <li>
              Income Certificate
              <div class="action-buttons">
                <input type="file" id="income-upload" class="hidden-file-input">
                <button class="btn btn-primary upload-doc-btn" data-target="income-upload">Upload</button>
                <button class="btn btn-danger delete-doc-btn">Delete</button>
              </div>
            </li>
            <li>
              Caste Certificate
              <div class="action-buttons">
                <input type="file" id="caste-upload" class="hidden-file-input">
                <button class="btn btn-primary upload-doc-btn" data-target="caste-upload">Upload</button>
                <button class="btn btn-danger delete-doc-btn">Delete</button>
              </div>
            </li>
            <li>
              Domicile Certificate
              <div class="action-buttons">
                <input type="file" id="domicile-upload" class="hidden-file-input">
                <button class="btn btn-primary upload-doc-btn" data-target="domicile-upload">Upload</button>
                <button class="btn btn-danger delete-doc-btn">Delete</button>
              </div>
            </li>
          </ul>
        </div>

        <!-- Document Section 4 -->
        <div class="document-section">
          <h2>4. Health & Medical Records</h2>
          <ul class="document-list">
            <li>
              Medical Fitness Certificate
              <div class="action-buttons">
                <input type="file" id="medical-upload" class="hidden-file-input">
                <button class="btn btn-primary upload-doc-btn" data-target="medical-upload">Upload</button>
                <button class="btn btn-danger delete-doc-btn">Delete</button>
              </div>
            </li>
            <li>
              Disability Certificate (if applicable)
              <div class="action-buttons">
                <input type="file" id="disability-upload" class="hidden-file-input">
                <button class="btn btn-primary upload-doc-btn" data-target="disability-upload">Upload</button>
                <button class="btn btn-danger delete-doc-btn">Delete</button>
              </div>
            </li>
          </ul>
        </div>

        <!-- Custom Certificate Section -->
        <div class="document-section">
          <h2>5. Add Custom Certificate</h2>
          <div class="custom-certificate">
            <p>Can't find what you need? Add your own custom certificate type below.</p>
            <div class="certificate-input">
              <div class="form-group">
                <label for="custom-cert-name">Certificate Name</label>
                <input type="text" id="custom-cert-name" placeholder="e.g., Language Proficiency Certificate">
              </div>
              <button id="add-custom-cert-btn" class="btn btn-primary">Add Certificate</button>
            </div>
            
            <!-- Container for custom certificates -->
            <div class="mt-4">
              <h3>Your Custom Certificates</h3>
              <ul id="custom-certificates-list" class="document-list">
                <!-- Custom certificates will be added here by JavaScript -->
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="contact-info mb-4">
          <h4>Contact Us</h4>
          <p>scholarvault@gmail.com</p>
          <p>6238280918</p>
        </div>
      </div>
      
      <div class="footer-bottom">
        <p>&copy; 2023 ScholarVault. All rights reserved.</p>
      </div>
    </div>
  </footer>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
        const token = localStorage.getItem('token');
        const userId = localStorage.getItem('userId');
    
        if (!token || !userId) {
            alert('Please log in to access the Document Vault.');
            window.location.href = 'loginstud.html';
            return;
        }
    
        const documentTypes = {
            'aadhaar-upload': 'Aadhaar Card',
            'pan-upload': 'PAN Card',
            'birth-upload': 'Birth Certificate',
            'passport-upload': 'Passport',
            'license-upload': 'Driving License',
            '10th-marksheet-upload': '10th Mark Sheet',
            '12th-marksheet-upload': '12th Mark Sheet',
            'ug-marksheet-upload': 'UG Mark Sheet',
            'pg-marksheet-upload': 'PG Mark Sheet',
            'passing-upload': 'Passing Certificate',
            'school-tc-upload': 'School Transfer Certificate (TC)',
            'college-tc-upload': 'College Transfer Certificate (TC)',
            'degree-upload': 'Degree Certificate',
            'bonafide-upload': 'Bonafide Certificate',
            'income-upload': 'Income Certificate',
            'caste-upload': 'Caste Certificate',
            'domicile-upload': 'Domicile Certificate',
            'medical-upload': 'Medical Fitness Certificate',
            'disability-upload': 'Disability Certificate'
        };
    
        let uploadedDocuments = [];
    
        async function fetchDocuments() {
            try {
                const response = await fetch('http://127.0.0.1:5000/user/documents', {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });
    
                const result = await response.json();
                console.log("Documents response:", result);
    
                if (response.ok) {
                    uploadedDocuments = result.data || [];
                    updateDocumentUI();
                } else {
                    alert(result.message || 'Failed to fetch documents');
                }
            } catch (error) {
                console.error('Fetch documents error:', error.message);
                alert(`An error occurred while fetching documents: ${error.message}`);
            }
        }
    
        function updateDocumentUI() {
            document.querySelectorAll('.document-list li').forEach(li => {
                const fileInput = li.querySelector('.hidden-file-input');
                const uploadBtn = li.querySelector('.upload-doc-btn');
                const actionButtons = li.querySelector('.action-buttons');
                const docType = documentTypes[fileInput.id];
    
                // Clear existing buttons except upload
                actionButtons.querySelectorAll('.download-doc-btn, .delete-doc-btn').forEach(btn => btn.remove());
    
                const existingDoc = uploadedDocuments.find(doc => doc.document_type === docType);
                if (existingDoc) {
                    uploadBtn.textContent = 'Uploaded';
                    uploadBtn.style.backgroundColor = '#10b981';
                    uploadBtn.disabled = true;
                    uploadBtn.setAttribute('data-document-id', existingDoc.id);
    
                    const downloadBtn = document.createElement('button');
                    downloadBtn.className = 'btn btn-success download-doc-btn';
                    downloadBtn.textContent = 'Download';
                    downloadBtn.setAttribute('data-document-id', existingDoc.id);
                    actionButtons.appendChild(downloadBtn);
    
                    const deleteBtn = document.createElement('button');
                    deleteBtn.className = 'btn btn-danger delete-doc-btn';
                    deleteBtn.textContent = 'Delete';
                    deleteBtn.setAttribute('data-document-id', existingDoc.id);
                    actionButtons.appendChild(deleteBtn);
    
                    downloadBtn.addEventListener('click', handleDownload);
                    deleteBtn.addEventListener('click', handleDelete);
                } else {
                    uploadBtn.textContent = 'Upload';
                    uploadBtn.style.backgroundColor = '';
                    uploadBtn.disabled = false;
                    uploadBtn.removeAttribute('data-document-id');
                }
            });
        }
    
        async function handleUpload(fileInput, docType) {
            const file = fileInput.files[0];
            if (!file) {
                alert('Please select a file to upload');
                return;
            }
    
            const formData = new FormData();
            formData.append('file', file);
            formData.append('document_type', docType);
    
            try {
                const response = await fetch('http://127.0.0.1:5000/upload_document', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    },
                    body: formData
                });
    
                const result = await response.json();
                console.log("Upload response:", result);
    
                if (response.ok) {
                    alert('Document uploaded successfully!');
                    uploadedDocuments.push({
                        id: result.data.document_id,
                        filename: result.data.filename,
                        upload_date: result.data.upload_date,
                        download_url: `/download_document/${result.data.document_id}`,
                        document_type: result.data.document_type
                    });
                    fileInput.value = '';
                    updateDocumentUI();
                } else {
                    alert(result.message || 'Failed to upload document');
                }
            } catch (error) {
                console.error('Upload error:', error.message);
                alert(`An error occurred while uploading the document: ${error.message}`);
            }
        }
    
        async function handleDownload(event) {
            const documentId = event.target.getAttribute('data-document-id');
            try {
                const response = await fetch(`http://127.0.0.1:5000/download_document/${documentId}`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
    
                if (response.ok) {
                    const blob = await response.blob();
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = response.headers.get('Content-Disposition')?.split('filename=')[1] || `document_${documentId}`;
                    document.body.appendChild(a);
                    a.click();
                    a.remove();
                    window.URL.revokeObjectURL(url);
                } else {
                    const result = await response.json();
                    alert(result.message || 'Failed to download document');
                }
            } catch (error) {
                console.error('Download error:', error.message);
                alert(`An error occurred while downloading the document: ${error.message}`);
            }
        }
    
        async function handleDelete(event) {
            const documentId = event.target.getAttribute('data-document-id');
            if (!confirm('Are you sure you want to delete this document?')) return;
    
            try {
                const response = await fetch(`http://127.0.0.1:5000/delete_document/${documentId}`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });
    
                const result = await response.json();
                console.log("Delete response:", result);
    
                if (response.ok) {
                    alert('Document deleted successfully!');
                    uploadedDocuments = uploadedDocuments.filter(doc => doc.id !== parseInt(documentId));
                    updateDocumentUI();
                } else {
                    alert(result.message || 'Failed to delete document');
                }
            } catch (error) {
                console.error('Delete error:', error.message);
                alert(`An error occurred while deleting the document: ${error.message}`);
            }
        }
    
        document.querySelectorAll('.upload-doc-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const targetId = this.getAttribute('data-target');
                const fileInput = document.getElementById(targetId);
                if (fileInput) {
                    fileInput.click();
                }
            });
        });
    
        document.querySelectorAll('.hidden-file-input').forEach(input => {
            input.addEventListener('change', function() {
                const docType = documentTypes[input.id] || input.closest('li')?.textContent.trim().split('\n')[0];
                handleUpload(input, docType);
            });
        });
    
        const addCustomCertBtn = document.getElementById('add-custom-cert-btn');
        const customCertInput = document.getElementById('custom-cert-name');
        const customCertsList = document.getElementById('custom-certificates-list');
        let certCounter = 1;
    
        addCustomCertBtn.addEventListener('click', function() {
            const certName = customCertInput.value.trim();
            if (certName) {
                const certId = 'custom-cert-' + certCounter;
                const uploadId = 'custom-upload-' + certCounter;
                certCounter++;
    
                documentTypes[uploadId] = certName;
    
                const li = document.createElement('li');
                li.className = 'custom-cert-item';
                li.innerHTML = `
                    ${certName}
                    <div class="action-buttons">
                        <input type="file" id="${uploadId}" class="hidden-file-input">
                        <button class="btn btn-primary upload-doc-btn" data-target="${uploadId}">Upload</button>
                        <button class="btn btn-danger remove-cert-btn">Remove</button>
                    </div>
                `;
    
                customCertsList.appendChild(li);
                customCertInput.value = '';
    
                const newUploadBtn = li.querySelector('.upload-doc-btn');
                newUploadBtn.addEventListener('click', function() {
                    const targetId = this.getAttribute('data-target');
                    const fileInput = document.getElementById(targetId);
                    if (fileInput) {
                        fileInput.click();
                    }
                });
    
                const newFileInput = li.querySelector('.hidden-file-input');
                newFileInput.addEventListener('change', function() {
                    const docType = certName;
                    handleUpload(newFileInput, docType);
                });
    
                const removeBtn = li.querySelector('.remove-cert-btn');
                removeBtn.addEventListener('click', async function() {
                    const documentId = li.querySelector('.upload-doc-btn')?.getAttribute('data-document-id');
                    if (documentId) {
                        await handleDelete({ target: { getAttribute: () => documentId } });
                    }
                    li.remove();
                });
            }
        });
    
        customCertInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                addCustomCertBtn.click();
            }
        });
    
        fetchDocuments();
    });
    </script>
</body>
</html>
